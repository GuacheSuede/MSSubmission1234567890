16
{"last_modification_time":1548363167,"language":1,"import_file":"/home/justin/MSCVProject/database/mongo-c-driver-1.13.1/src/libmongoc/tests/test-mongoc-topology-reconcile.c","args_hash":10433645398913005206,"includes":[{"line":7,"resolved_path":"/home/justin/MSCVProject/database/mongo-c-driver-1.13.1/src/libmongoc/tests/mock_server/future.h"},{"line":8,"resolved_path":"/home/justin/MSCVProject/database/mongo-c-driver-1.13.1/src/libmongoc/tests/mock_server/future-functions.h"},{"line":9,"resolved_path":"/home/justin/MSCVProject/database/mongo-c-driver-1.13.1/src/libmongoc/tests/mock_server/mock-server.h"},{"line":10,"resolved_path":"/home/justin/MSCVProject/database/mongo-c-driver-1.13.1/src/libmongoc/tests/TestSuite.h"},{"line":11,"resolved_path":"/home/justin/MSCVProject/database/mongo-c-driver-1.13.1/src/libmongoc/tests/test-conveniences.h"},{"line":12,"resolved_path":"/home/justin/MSCVProject/database/mongo-c-driver-1.13.1/src/libmongoc/tests/test-libmongoc.h"}],"dependencies":[],"skipped_by_preprocessor":[],"types":[{"id":0,"usr":17,"detailed_name":"","short_name_offset":0,"short_name_size":0,"kind":0,"hover":"","comments":"","declarations":[],"bases":[],"derived":[],"types":[],"funcs":[],"vars":[],"instances":[0,2,4,5,6,7,8,10,13,14,15,22,23,25,27],"uses":[]},{"id":1,"usr":13,"detailed_name":"","short_name_offset":0,"short_name_size":0,"kind":0,"hover":"","comments":"","declarations":[],"bases":[],"derived":[],"types":[],"funcs":[],"vars":[],"instances":[1,3,9,11,12,19,20,21,24,26],"uses":[]},{"id":2,"usr":44392140750487136,"detailed_name":"(anon struct)","short_name_offset":0,"short_name_size":13,"kind":23,"hover":"","comments":"","declarations":[],"spell":"330:9-330:15|-1|1|2","extent":"330:9-333:2|-1|1|0","bases":[],"derived":[],"types":[],"funcs":[],"vars":[13,14],"instances":[],"uses":[]},{"id":3,"usr":10481044582929556749,"detailed_name":"reconcile_test_data_t","short_name_offset":0,"short_name_size":21,"kind":252,"hover":"","comments":"","declarations":[],"spell":"333:3-333:24|-1|1|2","extent":"330:1-333:24|-1|1|0","alias_of":2,"bases":[],"derived":[],"types":[],"funcs":[],"vars":[],"instances":[16,18],"uses":["333:3-333:24|-1|1|4","339:4-339:25|-1|1|4","350:4-350:25|-1|1|4"]},{"id":4,"usr":2,"detailed_name":"","short_name_offset":0,"short_name_size":0,"kind":0,"hover":"","comments":"","declarations":[],"bases":[],"derived":[],"types":[],"funcs":[],"vars":[],"instances":[17],"uses":[]}],"funcs":[{"id":0,"usr":14980487444652970297,"detailed_name":"static int *get_node(int *topology, const char *host_and_port)","short_name_offset":12,"short_name_size":8,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"20:1-20:9|-1|1|2","extent":"19:1-41:2|-1|1|0","bases":[],"derived":[],"vars":[0,1],"uses":[],"callees":[]},{"id":1,"usr":15548521097807105367,"detailed_name":"static int has_server_description(int *topology, const char *host_and_port)","short_name_offset":11,"short_name_size":22,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"45:1-45:23|-1|1|2","extent":"44:1-64:2|-1|1|0","bases":[],"derived":[],"vars":[2,3,4],"uses":[],"callees":[]},{"id":2,"usr":4546384689742796257,"detailed_name":"int selects_server(int *client, int *read_prefs, int *server)","short_name_offset":4,"short_name_size":14,"kind":12,"storage":1,"hover":"","comments":"","declarations":[],"spell":"68:1-68:15|-1|1|2","extent":"67:1-90:2|-1|1|0","bases":[],"derived":[],"vars":[5,6,7],"uses":[],"callees":[]},{"id":3,"usr":677222170402450205,"detailed_name":"static void _test_topology_reconcile_rs(int pooled)","short_name_offset":12,"short_name_size":27,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"94:1-94:28|-1|1|2","extent":"93:1-192:2|-1|1|0","bases":[],"derived":[],"vars":[8,9],"uses":[],"callees":[]},{"id":4,"usr":4118851545791182599,"detailed_name":"static void test_topology_reconcile_rs_single()","short_name_offset":12,"short_name_size":33,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"196:1-196:34|-1|1|2","extent":"195:1-199:2|-1|1|0","bases":[],"derived":[],"vars":[],"uses":[],"callees":[]},{"id":5,"usr":16518367121555275973,"detailed_name":"static void test_topology_reconcile_rs_pooled()","short_name_offset":12,"short_name_size":33,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"203:1-203:34|-1|1|2","extent":"202:1-206:2|-1|1|0","bases":[],"derived":[],"vars":[],"uses":[],"callees":[]},{"id":6,"usr":10755900431957226628,"detailed_name":"static void _test_topology_reconcile_sharded(int pooled)","short_name_offset":12,"short_name_size":32,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"210:1-210:33|-1|1|2","extent":"209:1-313:2|-1|1|0","bases":[],"derived":[],"vars":[10,11,12],"uses":[],"callees":[]},{"id":7,"usr":1615963984968598112,"detailed_name":"static void test_topology_reconcile_sharded_single()","short_name_offset":12,"short_name_size":38,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"317:1-317:39|-1|1|2","extent":"316:1-320:2|-1|1|0","bases":[],"derived":[],"vars":[],"uses":[],"callees":[]},{"id":8,"usr":2353405941498647342,"detailed_name":"static void test_topology_reconcile_sharded_pooled()","short_name_offset":12,"short_name_size":38,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"324:1-324:39|-1|1|2","extent":"323:1-327:2|-1|1|0","bases":[],"derived":[],"vars":[],"uses":[],"callees":[]},{"id":9,"usr":9506655630536094190,"detailed_name":"static void server_opening(const int *event)","short_name_offset":12,"short_name_size":14,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"337:1-337:15|-1|1|2","extent":"336:1-344:2|-1|1|0","bases":[],"derived":[],"vars":[15,16],"uses":[],"callees":[]},{"id":10,"usr":11961185278727447496,"detailed_name":"static void test_topology_reconcile_from_handshake(void *ctx)","short_name_offset":12,"short_name_size":38,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"348:1-348:39|-1|1|2","extent":"347:1-435:2|-1|1|0","bases":[],"derived":[],"vars":[17,18,19,20,21,22],"uses":[],"callees":[]},{"id":11,"usr":9937947723122422969,"detailed_name":"static void _test_topology_reconcile_retire(int pooled)","short_name_offset":12,"short_name_size":31,"kind":12,"storage":3,"hover":"","comments":"CDRIVER-2552 in mongoc_topology_scanner_node_setup, assert (!node->retired)\nfailed after this sequence in pooled mode:\n\n1. scanner discovers a replica set with primary and at least one secondary\n2. cluster opens a new stream to the primary\n3. cluster handshakes the new connection by calling isMaster on the primary\n4. the primary, for some reason, suddenly omits the secondary from its host\n   list, perhaps because the secondary was removed from the RS configuration\n5. scanner marks the secondary scanner node \"retired\" to be destroyed later\n6. the scanner is disconnected from the secondary for some reason\n7. on the next scan, mongoc_topology_scanner_node_setup sees that the\n   secondary is disconnected, and before creating a new stream it asserts\n   !node->retired.\n\ntest that between step 5 and 7, mongoc_topology_scanner_reset destroys the\nsecondary node, avoiding the assert failure. test both pooled and single\nmode for good measure.","declarations":[],"spell":"457:1-457:32|-1|1|2","extent":"456:1-570:2|-1|1|0","bases":[],"derived":[],"vars":[23,24],"uses":[],"callees":[]},{"id":12,"usr":8012665894098545552,"detailed_name":"static void test_topology_reconcile_retire_single()","short_name_offset":12,"short_name_size":37,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"574:1-574:38|-1|1|2","extent":"573:1-577:2|-1|1|0","bases":[],"derived":[],"vars":[],"uses":[],"callees":[]},{"id":13,"usr":7331909331185242495,"detailed_name":"static void test_topology_reconcile_retire_pooled()","short_name_offset":12,"short_name_size":37,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"581:1-581:38|-1|1|2","extent":"580:1-584:2|-1|1|0","bases":[],"derived":[],"vars":[],"uses":[],"callees":[]},{"id":14,"usr":588901608263237245,"detailed_name":"static void _test_topology_reconcile_add(int pooled)","short_name_offset":12,"short_name_size":28,"kind":12,"storage":3,"hover":"","comments":"CDRIVER-2552 in mongoc_topology_scanner_start, assert (!node->cmd)\nfailed after this sequence in libmongoc 1.6.0:\n\n1. scanner discovers a replica set with primary\n2. cluster opens a new stream to the primary\n3. cluster handshakes the new connection by calling isMaster on the primary\n4. the primary suddenly includes a new secondary in its host list, perhaps\n   because the secondary was added\n5. _mongoc_topology_update_from_handshake adds the secondary to the topology\n   and erroneously creates a scanner node with an async_cmd_t for it,\n   although it's not in the scanner loop\n6. on the next mongoc_topology_scanner_start, assert (!node->cmd) fails\n\ntest that in step 5 the new node has no new async_cmd_t","declarations":[],"spell":"603:1-603:29|-1|1|2","extent":"602:1-698:2|-1|1|0","bases":[],"derived":[],"vars":[25,26],"uses":[],"callees":[]},{"id":15,"usr":4162023382695775522,"detailed_name":"static void test_topology_reconcile_add_single()","short_name_offset":12,"short_name_size":34,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"702:1-702:35|-1|1|2","extent":"701:1-705:2|-1|1|0","bases":[],"derived":[],"vars":[],"uses":[],"callees":[]},{"id":16,"usr":288340969940365911,"detailed_name":"static void test_topology_reconcile_add_pooled()","short_name_offset":12,"short_name_size":34,"kind":12,"storage":3,"hover":"","comments":"","declarations":[],"spell":"709:1-709:35|-1|1|2","extent":"708:1-712:2|-1|1|0","bases":[],"derived":[],"vars":[],"uses":[],"callees":[]},{"id":17,"usr":8692271990808446959,"detailed_name":"void test_topology_reconcile_install(int *suite)","short_name_offset":5,"short_name_size":31,"kind":12,"storage":1,"hover":"","comments":"","declarations":[],"spell":"716:1-716:32|-1|1|2","extent":"715:1-754:2|-1|1|0","bases":[],"derived":[],"vars":[27],"uses":[],"callees":[]}],"vars":[{"id":0,"usr":5136012032858360957,"detailed_name":"int *topology","short_name_offset":5,"short_name_size":8,"hover":"","comments":"","declarations":[],"spell":"20:30-20:38|0|3|2","extent":"20:11-20:38|0|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":1,"usr":4215753766435630055,"detailed_name":"const char *host_and_port","short_name_offset":12,"short_name_size":13,"hover":"","comments":"","declarations":[],"spell":"20:52-20:65|0|3|2","extent":"20:40-20:65|0|3|0","type":1,"uses":[],"kind":253,"storage":1},{"id":2,"usr":8836551933440738283,"detailed_name":"int *topology","short_name_offset":5,"short_name_size":8,"hover":"","comments":"","declarations":[],"spell":"45:44-45:52|1|3|2","extent":"45:25-45:52|1|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":3,"usr":11281771801192494172,"detailed_name":"const char *host_and_port","short_name_offset":12,"short_name_size":13,"hover":"","comments":"","declarations":[],"spell":"45:66-45:79|1|3|2","extent":"45:54-45:79|1|3|0","type":1,"uses":[],"kind":253,"storage":1},{"id":4,"usr":6637237514091680017,"detailed_name":"int i","short_name_offset":4,"short_name_size":1,"hover":"","comments":"","declarations":[],"spell":"49:8-49:9|1|3|2","extent":"49:4-49:9|1|3|0","type":0,"uses":[],"kind":13,"storage":1},{"id":5,"usr":14163062218909524398,"detailed_name":"int *client","short_name_offset":5,"short_name_size":6,"hover":"","comments":"","declarations":[],"spell":"68:34-68:40|2|3|2","extent":"68:17-68:40|2|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":6,"usr":12293014948954809651,"detailed_name":"int *read_prefs","short_name_offset":5,"short_name_size":10,"hover":"","comments":"","declarations":[],"spell":"69:38-69:48|2|3|2","extent":"69:17-69:48|2|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":7,"usr":4028782598226119183,"detailed_name":"int *server","short_name_offset":5,"short_name_size":6,"hover":"","comments":"","declarations":[],"spell":"70:32-70:38|2|3|2","extent":"70:17-70:38|2|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":8,"usr":15726343582045963716,"detailed_name":"int pooled","short_name_offset":4,"short_name_size":6,"hover":"","comments":"","declarations":[],"spell":"94:35-94:41|3|3|2","extent":"94:30-94:41|3|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":9,"usr":14676280768918906064,"detailed_name":"char *uri_str","short_name_offset":6,"short_name_size":7,"hover":"","comments":"","declarations":[],"spell":"98:10-98:17|3|3|2","extent":"98:4-98:17|3|3|0","type":1,"uses":["189:15-189:22|3|3|12"],"kind":13,"storage":1},{"id":10,"usr":14300768017473872895,"detailed_name":"int pooled","short_name_offset":4,"short_name_size":6,"hover":"","comments":"","declarations":[],"spell":"210:40-210:46|6|3|2","extent":"210:35-210:46|6|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":11,"usr":7392630288732549907,"detailed_name":"char *uri_str","short_name_offset":6,"short_name_size":7,"hover":"","comments":"","declarations":[],"spell":"214:10-214:17|6|3|2","extent":"214:4-214:17|6|3|0","type":1,"uses":["310:15-310:22|6|3|12"],"kind":13,"storage":1},{"id":12,"usr":14967831356298950323,"detailed_name":"char *secondary_response","short_name_offset":6,"short_name_size":18,"hover":"","comments":"","declarations":[],"spell":"222:10-222:28|6|3|2","extent":"222:4-222:28|6|3|0","type":1,"uses":["298:15-298:33|6|3|12"],"kind":13,"storage":1},{"id":13,"usr":5676103793491578047,"detailed_name":"int (anon struct)::mutex","short_name_offset":19,"short_name_size":5,"hover":"","comments":"","declarations":[],"spell":"331:17-331:22|2|2|2","extent":"331:4-331:22|2|2|0","type":0,"uses":[],"kind":8,"storage":0},{"id":14,"usr":13082581611822696618,"detailed_name":"int (anon struct)::servers","short_name_offset":19,"short_name_size":7,"hover":"","comments":"","declarations":[],"spell":"332:11-332:18|2|2|2","extent":"332:4-332:18|2|2|0","type":0,"uses":[],"kind":8,"storage":0},{"id":15,"usr":6467367169945813753,"detailed_name":"const int *event","short_name_offset":11,"short_name_size":5,"hover":"","comments":"","declarations":[],"spell":"337:52-337:57|9|3|2","extent":"337:17-337:57|9|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":16,"usr":4180569207474927053,"detailed_name":"reconcile_test_data_t *data","short_name_offset":23,"short_name_size":4,"hover":"","comments":"","declarations":[],"spell":"339:27-339:31|9|3|2","extent":"339:4-339:31|9|3|0","type":3,"uses":[],"kind":13,"storage":1},{"id":17,"usr":7316860048362444696,"detailed_name":"void *ctx","short_name_offset":6,"short_name_size":3,"hover":"","comments":"","declarations":[],"spell":"348:47-348:50|10|3|2","extent":"348:41-348:50|10|3|0","type":4,"uses":[],"kind":253,"storage":1},{"id":18,"usr":14086873246512866247,"detailed_name":"reconcile_test_data_t data","short_name_offset":22,"short_name_size":4,"hover":"","comments":"","declarations":[],"spell":"350:26-350:30|10|3|2","extent":"350:4-350:30|10|3|0","type":3,"uses":[],"kind":13,"storage":1},{"id":19,"usr":1624273620398051525,"detailed_name":"char *host_and_port","short_name_offset":6,"short_name_size":13,"hover":"","comments":"","declarations":[],"spell":"352:10-352:23|10|3|2","extent":"352:4-352:23|10|3|0","type":1,"uses":["371:4-371:17|10|3|20","374:38-374:51|10|3|12","434:15-434:28|10|3|12"],"kind":13,"storage":1},{"id":20,"usr":11334536573437162644,"detailed_name":"char *replset_name","short_name_offset":6,"short_name_size":12,"hover":"","comments":"","declarations":[],"spell":"353:10-353:22|10|3|2","extent":"353:4-353:22|10|3|0","type":1,"uses":["372:4-372:16|10|3|20","374:53-374:65|10|3|12","433:15-433:27|10|3|12"],"kind":13,"storage":1},{"id":21,"usr":16712934699353074816,"detailed_name":"char *uri_str","short_name_offset":6,"short_name_size":7,"hover":"","comments":"","declarations":[],"spell":"354:10-354:17|10|3|2","extent":"354:4-354:17|10|3|0","type":1,"uses":["373:4-373:11|10|3|20","432:15-432:22|10|3|12"],"kind":13,"storage":1},{"id":22,"usr":9214091187595762419,"detailed_name":"int count","short_name_offset":4,"short_name_size":5,"hover":"","comments":"","declarations":[],"spell":"361:8-361:13|10|3|2","extent":"361:4-361:13|10|3|0","type":0,"uses":[],"kind":13,"storage":1},{"id":23,"usr":1890785940520123071,"detailed_name":"int pooled","short_name_offset":4,"short_name_size":6,"hover":"","comments":"","declarations":[],"spell":"457:39-457:45|11|3|2","extent":"457:34-457:45|11|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":24,"usr":13107225067475195470,"detailed_name":"char *uri_str","short_name_offset":6,"short_name_size":7,"hover":"","comments":"","declarations":[],"spell":"461:10-461:17|11|3|2","extent":"461:4-461:17|11|3|0","type":1,"uses":["569:15-569:22|11|3|12"],"kind":13,"storage":1},{"id":25,"usr":10256126683292549572,"detailed_name":"int pooled","short_name_offset":4,"short_name_size":6,"hover":"","comments":"","declarations":[],"spell":"603:36-603:42|14|3|2","extent":"603:31-603:42|14|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":26,"usr":17246851671912865177,"detailed_name":"char *uri_str","short_name_offset":6,"short_name_size":7,"hover":"","comments":"","declarations":[],"spell":"607:10-607:17|14|3|2","extent":"607:4-607:17|14|3|0","type":1,"uses":["697:15-697:22|14|3|12"],"kind":13,"storage":1},{"id":27,"usr":5442094700568417878,"detailed_name":"int *suite","short_name_offset":5,"short_name_size":5,"hover":"","comments":"","declarations":[],"spell":"716:45-716:50|17|3|2","extent":"716:34-716:50|17|3|0","type":0,"uses":[],"kind":253,"storage":1},{"id":28,"usr":8192665602809672247,"detailed_name":"MONGOC_LOG_DOMAIN","short_name_offset":0,"short_name_size":17,"hover":"#define MONGOC_LOG_DOMAIN \"topology-reconcile-test\"","comments":"","declarations":[],"spell":"16:9-16:26|-1|1|2","extent":"16:9-16:52|-1|1|0","uses":[],"kind":255,"storage":0}]}